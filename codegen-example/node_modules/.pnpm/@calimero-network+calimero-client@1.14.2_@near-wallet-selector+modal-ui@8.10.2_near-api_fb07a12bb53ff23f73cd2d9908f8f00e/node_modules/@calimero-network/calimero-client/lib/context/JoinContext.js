import React, { useState } from 'react';
import Spinner from '../components/loader/Spinner';
import { apiClient } from '../api';
import { Button, ErrorMessage, FormGroup, FormInput, Heading2, Paragraph, SuccessMessage, } from './Components';
export const JoinContext = () => {
    const [identityPrivateKey, setIdentityPrivateKey] = useState('');
    const [joinPayload, setJoinPayload] = useState('');
    const [joinError, setJoinError] = useState('');
    const [isLoading, setIsLoading] = useState(false);
    const [isSuccess, setIsSuccess] = useState(false);
    const handleJoinSubmit = async (e) => {
        e.preventDefault();
        setIsLoading(true);
        setJoinError('');
        setIsSuccess(false);
        const response = await apiClient
            .node()
            .joinContext(joinPayload);
        if (response.error) {
            setJoinError(response.error.message);
        }
        else {
            if (response.data.contextId && response.data.memberPublicKey) {
                setIsSuccess(true);
                setJoinError('');
            }
        }
        setIsLoading(false);
    };
    return (React.createElement("div", { className: "join-tab" },
        React.createElement(Heading2, null, "Join Existing Context"),
        React.createElement(Paragraph, null, "To join context you need to have invitation payload."),
        React.createElement("form", { onSubmit: handleJoinSubmit },
            React.createElement(FormGroup, null,
                React.createElement(FormInput, { type: "text", value: identityPrivateKey, onChange: (e) => setIdentityPrivateKey(e.target.value), placeholder: "Enter your identity private key" })),
            React.createElement(FormGroup, null,
                React.createElement(FormInput, { type: "text", value: joinPayload, onChange: (e) => setJoinPayload(e.target.value), placeholder: "Paste invitation payload" })),
            joinError && React.createElement(ErrorMessage, null, joinError),
            isSuccess && (React.createElement(SuccessMessage, null, "Successfully joined context")),
            React.createElement(Button, { type: "submit", className: "button-rounded button-size-md", disabled: isLoading || !identityPrivateKey || !joinPayload }, isLoading ? React.createElement(Spinner, null) : 'Join'))));
};
